% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/write.R
\name{sheet_trunc_unique}
\alias{sheet_trunc_unique}
\title{Make Excel-safe unique sheet names with truncation and numbering}
\usage{
sheet_trunc_unique(x, width = 31)
}
\arguments{
\item{x}{A character vector of proposed sheet names.}

\item{width}{Integer scalar, maximum allowed length (default \code{31} for Excel).}
}
\value{
A character vector the same length as \code{x}, with unique names of length
\verb{<= width}.
}
\description{
Produces sheet names that:
\itemize{
\item respect Excel's 31-character limit
\item are unique, even when the first 31 characters are identical
}

The first occurrence of each name is truncated with an ellipsis via
\code{\link[stringr:str_trunc]{stringr::str_trunc()}} (so it ends with \code{"..."} if needed). Any collisions
(including with pre-existing user-provided names) are resolved by appending
a numeric suffix like \code{".(2)"}, \code{".(3)"}, â€¦ while re-truncating the base so
the total length never exceeds \code{width}. If the base already ends with a dot,
the extra dot in the suffix is omitted to avoid \code{"..(n)"}.
}
\keyword{internal}
