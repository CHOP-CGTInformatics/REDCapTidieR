<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Using Labelled Vectors with REDCapTidieR • REDCapTidieR</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Fira_Code-0.4.9/font.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Using Labelled Vectors with REDCapTidieR">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">REDCapTidieR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.2.1.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../index.html"><span class="fa fa-home"></span></a></li>
<li class="nav-item"><a class="nav-link" href="../articles/REDCapTidieR.html">Get Started</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/glossary.html">Glossary</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/diving_deeper.html">Diving Deeper: Understanding REDCapTidieR Data Tibbles</a></li>
    <li><a class="dropdown-item" href="../articles/export_to_xlsx.html">Exporting to Excel</a></li>
    <li><a class="dropdown-item" href="../articles/labelled.html">Using Labelled Vectors with REDCapTidieR</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/CHOP-CGTInformatics/REDCapTidieR/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Using Labelled Vectors with REDCapTidieR</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/CHOP-CGTInformatics/REDCapTidieR/blob/main/vignettes/articles/labelled.Rmd" class="external-link"><code>vignettes/articles/labelled.Rmd</code></a></small>
      <div class="d-none name"><code>labelled.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="options-for-importing-categorical-variables">Options for Importing Categorical Variables<a class="anchor" aria-label="anchor" href="#options-for-importing-categorical-variables"></a>
</h2>
<p>When importing data from REDCap using <code><a href="../reference/read_redcap.html">read_redcap()</a></code>, you
have several options for handling coded categorical variables. These
options determine how the coded values are represented in your R
environment.</p>
<p>For this vignette, we will be using a sample <a href="https://chop-cgtinformatics.github.io/REDCapTidieR/articles/glossary.html#classic-project">classic
project</a> with a <a href="https://chop-cgtinformatics.github.io/REDCapTidieR/articles/glossary.html#form">form</a>
that comprises most common REDCap data types.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://chop-cgtinformatics.github.io/REDCapTidieR/">REDCapTidieR</a></span><span class="op">)</span></span>
<span><span class="va">token</span> <span class="op">&lt;-</span> <span class="st">"123456789ABCDEF123456789ABCDEF04"</span></span>
<span><span class="va">redcap_uri</span> <span class="op">&lt;-</span> <span class="st">"https://my.institution.edu/redcap/api/"</span></span></code></pre></div>
<p>Using <code>raw_or_label = "raw"</code> retrieves the raw coded
values for categorical variables. This approach preserves the original
coding, but you’ll need to separately reference the data dictionary from
REDCap to interpret the meaning of each code.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">redcap_form</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/read_redcap.html">read_redcap</a></span><span class="op">(</span></span>
<span>    <span class="va">redcap_uri</span>,</span>
<span>    <span class="va">token</span>,</span>
<span>    raw_or_label <span class="op">=</span> <span class="st">"raw"</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/extract_tibble.html">extract_tibble</a></span><span class="op">(</span><span class="st">"labelled_vignette"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">redcap_form</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 4 × 7</span></span></span>
<span><span class="co">#&gt;   record_id text_box_1 radio_buttons_1 checkbox___1 checkbox___2 checkbox___3</span></span>
<span><span class="co">#&gt;       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>         1 Record 1                 1            1            0            0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>         2 Record 2                 2            1            1            0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span>         3 Record 3                 3            0            1            1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span>         4 Record 4                 1            0            0            0</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 1 more variable: form_status_complete &lt;dbl&gt;</span></span></span></code></pre></div>
<p>The default option, <code>raw_or_label = "label"</code>, replaces
each code with its corresponding label and converts categorical
variables into factors. This is convenient for analysis but discards the
original numeric codes, which may be necessary for tasks like data
cleaning or re-exporting to other formats (e.g., Stata or SPSS).</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">redcap_form</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/read_redcap.html">read_redcap</a></span><span class="op">(</span></span>
<span>    <span class="va">redcap_uri</span>,</span>
<span>    <span class="va">token</span>,</span>
<span>    raw_or_label <span class="op">=</span> <span class="st">"label"</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/extract_tibble.html">extract_tibble</a></span><span class="op">(</span><span class="st">"labelled_vignette"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">redcap_form</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 4 × 7</span></span></span>
<span><span class="co">#&gt;   record_id text_box_1 radio_buttons_1 checkbox___1 checkbox___2 checkbox___3</span></span>
<span><span class="co">#&gt;       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>         1 Record 1   A               TRUE         FALSE        FALSE       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>         2 Record 2   B               TRUE         TRUE         FALSE       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span>         3 Record 3   C               FALSE        TRUE         TRUE        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span>         4 Record 4   A               FALSE        FALSE        FALSE       </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 1 more variable: form_status_complete &lt;fct&gt;</span></span></span></code></pre></div>
<p>A third option, <code>raw_or_label = "haven_labelled"</code>, imports
categorical variables as labelled vectors using the “haven_labelled”
class from the haven package
(cf. <code><a href="https://haven.tidyverse.org/articles/semantics.html" class="external-link">vignette("semantics", package = "haven")</a></code>). This method
imports your categorical variables using their original coding and
attaches the corresponding value labels to them as metadata.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">redcap_form</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/read_redcap.html">read_redcap</a></span><span class="op">(</span></span>
<span>    <span class="va">redcap_uri</span>,</span>
<span>    <span class="va">token</span>,</span>
<span>    raw_or_label <span class="op">=</span> <span class="st">"haven"</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/extract_tibble.html">extract_tibble</a></span><span class="op">(</span><span class="st">"labelled_vignette"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">redcap_form</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 4 × 7</span></span></span>
<span><span class="co">#&gt;   record_id text_box_1 radio_buttons_1 checkbox___1 checkbox___2 checkbox___3</span></span>
<span><span class="co">#&gt;       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl+lbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>         1 Record 1   1<span style="color: #949494;"> [A]</span>           TRUE         FALSE        FALSE       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>         2 Record 2   2<span style="color: #949494;"> [B]</span>           TRUE         TRUE         FALSE       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span>         3 Record 3   3<span style="color: #949494;"> [C]</span>           FALSE        TRUE         TRUE        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span>         4 Record 4   1<span style="color: #949494;"> [A]</span>           FALSE        FALSE        FALSE       </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 1 more variable: form_status_complete &lt;dbl+lbl&gt;</span></span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="pros-cons-of-labelled-vectors">Pros &amp; Cons of Labelled Vectors<a class="anchor" aria-label="anchor" href="#pros-cons-of-labelled-vectors"></a>
</h2>
<p>The <code>"haven_labelled"</code> class was originally developed to
import data from statistical software like SPSS, Stata, or SAS, which
use value labels for categorical variables. This format allows you store
both the original coding and the labels attached to each value.</p>
<div class="section level3">
<h3 id="advantages">Advantages<a class="anchor" aria-label="anchor" href="#advantages"></a>
</h3>
<ul>
<li>
<strong>Preservation of Original Coding</strong>: Both numeric codes
and labels are retained, which is useful for data cleaning and
re-exporting.</li>
<li>
<strong>Metadata Management</strong>: The labelled package offers
functions to manage value labels effectively.</li>
</ul>
<p>You can manipulate value labels using functions such as:</p>
<ul>
<li><code><a href="https://larmarange.github.io/labelled/reference/val_labels.html" class="external-link">labelled::set_value_labels()</a></code></li>
<li><code><a href="https://larmarange.github.io/labelled/reference/val_labels.html" class="external-link">labelled::get_value_labels()</a></code></li>
<li><code><a href="https://larmarange.github.io/labelled/reference/val_labels.html" class="external-link">labelled::add_value_labels()</a></code></li>
<li><code><a href="https://larmarange.github.io/labelled/reference/val_labels.html" class="external-link">labelled::remove_value_labels()</a></code></li>
</ul>
<p>Additionally, you can search through variables or generate a variable
dictionary with <code><a href="https://larmarange.github.io/labelled/reference/look_for.html" class="external-link">labelled::look_for()</a></code>
(cf. <code><a href="https://larmarange.github.io/labelled/articles/look_for.html" class="external-link">vignette("look_for", package = "labelled")</a></code>):</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://larmarange.github.io/labelled/" class="external-link">labelled</a></span><span class="op">)</span></span>
<span><span class="va">redcap_form</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://larmarange.github.io/labelled/reference/look_for.html" class="external-link">look_for</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;  pos variable             label col_type missing values        </span></span>
<span><span class="co">#&gt;  1   record_id            —     dbl      0                     </span></span>
<span><span class="co">#&gt;  2   text_box_1           —     chr      0                     </span></span>
<span><span class="co">#&gt;  3   radio_buttons_1      —     dbl+lbl  0       [1] A         </span></span>
<span><span class="co">#&gt;                                                  [2] B         </span></span>
<span><span class="co">#&gt;                                                  [3] C         </span></span>
<span><span class="co">#&gt;  4   checkbox___1         —     lgl      0                     </span></span>
<span><span class="co">#&gt;  5   checkbox___2         —     lgl      0                     </span></span>
<span><span class="co">#&gt;  6   checkbox___3         —     lgl      0                     </span></span>
<span><span class="co">#&gt;  7   form_status_complete —     dbl+lbl  0       [0] Incomplete</span></span>
<span><span class="co">#&gt;                                                  [1] Unverified</span></span>
<span><span class="co">#&gt;                                                  [2] Complete</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="disadvantages">Disadvantages<a class="anchor" aria-label="anchor" href="#disadvantages"></a>
</h3>
<p>Labelled vectors are not optimized for data analysis tasks like
descriptive statistics, plotting, or modeling. For these purposes,
categorical variables should be converted to factors or numeric
vectors.</p>
</div>
<div class="section level3">
<h3 id="recommended-approaches">Recommended Approaches<a class="anchor" aria-label="anchor" href="#recommended-approaches"></a>
</h3>
<div class="float">
<img src="images%2Flabelled_approaches.png" alt="labelled Approaches"><div class="figcaption">labelled Approaches</div>
</div>
<p><strong>Approach A</strong>: Convert <code>haven_labelled</code>
vectors to factors or numeric/character vectors just after import using
functions like <code><a href="https://larmarange.github.io/labelled/reference/to_factor.html" class="external-link">labelled::unlabelled()</a></code>,
<code><a href="https://larmarange.github.io/labelled/reference/to_factor.html" class="external-link">labelled::to_factor()</a></code>, or <code><a href="https://rdrr.io/r/base/class.html" class="external-link">unclass()</a></code>. Proceed
with data cleaning, recoding, and analysis using standard R vector
types.</p>
<p><strong>Approach B</strong>: Retain <code>haven_labelled</code>
vectors for data cleaning and coding to preserve original labels,
especially if you plan to re-export the data. Use labelled functions to
manage value labels, but convert the vectors to factors or numeric types
before performing analysis or modeling.</p>
</div>
</div>
<div class="section level2">
<h2 id="managing-variable-labels">Managing Variable Labels<a class="anchor" aria-label="anchor" href="#managing-variable-labels"></a>
</h2>
<p>It’s important to distinguish between value labels and variable
labels:</p>
<ul>
<li>
<strong>Value Labels</strong>: Describe the meaning of specific
values within a vector and change the vector’s class to
<code>"haven_labelled"</code>.</li>
<li>
<strong>Variable Labels</strong>: Provide a textual description of
the entire variable without altering its class.</li>
</ul>
<p>The labelled package offers functions to handle variable labels, such
as:</p>
<ul>
<li><code><a href="https://larmarange.github.io/labelled/reference/var_label.html" class="external-link">labelled::set_variable_labels()</a></code></li>
<li><code><a href="https://larmarange.github.io/labelled/reference/var_label.html" class="external-link">labelled::get_variable_labels()</a></code></li>
</ul>
<p>Using <code><a href="../reference/make_labelled.html">REDCapTidieR::make_labelled()</a></code> allows you to add
variable labels to data frames exported from REDCap:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">redcap_form</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/read_redcap.html">read_redcap</a></span><span class="op">(</span></span>
<span>    <span class="va">redcap_uri</span>,</span>
<span>    <span class="va">token</span>,</span>
<span>    raw_or_label <span class="op">=</span> <span class="st">"haven"</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/make_labelled.html">make_labelled</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/extract_tibble.html">extract_tibble</a></span><span class="op">(</span><span class="st">"labelled_vignette"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">redcap_form</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://larmarange.github.io/labelled/reference/look_for.html" class="external-link">look_for</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;  pos variable             label                col_type missing values        </span></span>
<span><span class="co">#&gt;  1   record_id            Record ID            dbl      0                     </span></span>
<span><span class="co">#&gt;  2   text_box_1           Text Box             chr      0                     </span></span>
<span><span class="co">#&gt;  3   radio_buttons_1      Radio Buttons        dbl+lbl  0       [1] A         </span></span>
<span><span class="co">#&gt;                                                                 [2] B         </span></span>
<span><span class="co">#&gt;                                                                 [3] C         </span></span>
<span><span class="co">#&gt;  4   checkbox___1         Checkbox: A          lgl      0                     </span></span>
<span><span class="co">#&gt;  5   checkbox___2         Checkbox: B          lgl      0                     </span></span>
<span><span class="co">#&gt;  6   checkbox___3         Checkbox: C          lgl      0                     </span></span>
<span><span class="co">#&gt;  7   form_status_complete REDCap Instrument C~ dbl+lbl  0       [0] Incomplete</span></span>
<span><span class="co">#&gt;                                                                 [1] Unverified</span></span>
<span><span class="co">#&gt;                                                                 [2] Complete</span></span></code></pre></div>
<p>This ensures that your data not only retains value labels but also
includes descriptive labels for each variable, enhancing the readability
and usability of your dataset.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Richard Hanna, Stephan Kadauke, Ezra Porter.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
