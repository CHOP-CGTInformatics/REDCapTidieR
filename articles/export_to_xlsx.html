<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Exporting to Excel • REDCapTidieR</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Fira_Code-0.4.9/font.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Exporting to Excel">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">REDCapTidieR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.2.1.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../index.html"><span class="fa fa-home"></span></a></li>
<li class="nav-item"><a class="nav-link" href="../articles/REDCapTidieR.html">Get Started</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/glossary.html">Glossary</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/diving_deeper.html">Diving Deeper: Understanding REDCapTidieR Data Tibbles</a></li>
    <li><a class="dropdown-item" href="../articles/export_to_xlsx.html">Exporting to Excel</a></li>
    <li><a class="dropdown-item" href="../articles/labelled.html">Using Labelled Vectors with REDCapTidieR</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/CHOP-CGTInformatics/REDCapTidieR/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">



<link href="export_to_xlsx_files/pagedtable-1.1/css/pagedtable.css" rel="stylesheet">
<script src="export_to_xlsx_files/pagedtable-1.1/js/pagedtable.js"></script><div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Exporting to Excel</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/CHOP-CGTInformatics/REDCapTidieR/blob/main/vignettes/articles/export_to_xlsx.Rmd" class="external-link"><code>vignettes/articles/export_to_xlsx.Rmd</code></a></small>
      <div class="d-none name"><code>export_to_xlsx.Rmd</code></div>
    </div>

    
    
<p>Excel spreadsheets are an accessible medium for data analysis and
collaboration. This vignette will guide you through the process of using
REDCapTidieR to transform your REDCap data into an XLSX document,
facilitating easy sharing with colleagues.</p>
<p><code><a href="../reference/write_redcap_xlsx.html">write_redcap_xlsx()</a></code> also works with
<code><a href="../reference/add_skimr_metadata.html">add_skimr_metadata()</a></code> to supply both labelled and unlabelled
skimr metadata metrics to your XLSX document.</p>
<div class="section level2">
<h2 id="transforming-a-redcap-project-into-an-xlsx-document">Transforming a REDCap project into an XLSX document<a class="anchor" aria-label="anchor" href="#transforming-a-redcap-project-into-an-xlsx-document"></a>
</h2>
<p>The transformation of a REDCap <a href="glossary.html#project">project</a> into a XLSX document can be
achieved in three straightforward steps using the
<code><a href="../reference/write_redcap_xlsx.html">write_redcap_xlsx()</a></code> function:</p>
<ol style="list-style-type: decimal">
<li>Specify your REDCap URI and <a href="glossary.html#redcap-api">API</a> token.</li>
<li>Invoke <code><a href="../reference/read_redcap.html">read_redcap()</a></code>.</li>
<li>Apply <code><a href="../reference/write_redcap_xlsx.html">write_redcap_xlsx()</a></code>.</li>
</ol>
<p>Below is a practical illustration:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://chop-cgtinformatics.github.io/REDCapTidieR/">REDCapTidieR</a></span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">redcap_uri</span> <span class="op">&lt;-</span> <span class="st">"https://my.institution.edu/redcap/api/"</span></span>
<span><span class="va">token</span> <span class="op">&lt;-</span> <span class="st">"123456789ABCDEF123456789ABCDEF04"</span></span>
<span></span>
<span><span class="va">my_redcap_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_redcap.html">read_redcap</a></span><span class="op">(</span><span class="va">redcap_uri</span>, <span class="va">token</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/write_redcap_xlsx.html">write_redcap_xlsx</a></span><span class="op">(</span><span class="va">my_redcap_data</span>, file <span class="op">=</span> <span class="st">"my_redcap_data.xlsx"</span><span class="op">)</span></span></code></pre></div>
<p>The resulting file will contain the data corresponding to each REDCap
<a href="glossary.html#instrument">instrument</a> in a dedicated sheet.
Additionally, a “Table of Contents” sheet will be at the beginning, and
a “REDCap Metadata” sheet will be at the end.</p>
</div>
<div class="section level2">
<h2 id="diving-deeper">Diving Deeper<a class="anchor" aria-label="anchor" href="#diving-deeper"></a>
</h2>
<p>We will revisit the Superheroes dataset from the <a href="REDCapTidieR.html#case-study-the-superhero-database">Getting
Started</a> vignette.</p>
<p>First, we’ll use <code><a href="../reference/read_redcap.html">read_redcap()</a></code> to create the
<code>superheroes</code> <a href="glossary.html#supertibble">supertibble</a>:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">superheroes_token</span> <span class="op">&lt;-</span> <span class="st">"123456789ABCDEF123456789ABCDEF04"</span></span>
<span><span class="va">redcap_uri</span> <span class="op">&lt;-</span> <span class="st">"https://my.institution.edu/redcap/api/"</span></span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">superheroes</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_redcap.html">read_redcap</a></span><span class="op">(</span><span class="va">redcap_uri</span>, <span class="va">superheroes_token</span><span class="op">)</span></span>
<span></span>
<span><span class="va">superheroes</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">rmarkdown</span><span class="fu">::</span><span class="fu"><a href="https://pkgs.rstudio.com/rmarkdown/reference/paged_table.html" class="external-link">paged_table</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["redcap_form_name"],"name":[1],"type":["chr"],"align":["left"]},{"label":["redcap_form_label"],"name":[2],"type":["chr"],"align":["left"]},{"label":["redcap_data"],"name":[3],"type":["list"],"align":["right"]},{"label":["redcap_metadata"],"name":[4],"type":["list"],"align":["right"]},{"label":["structure"],"name":[5],"type":["chr"],"align":["left"]},{"label":["data_rows"],"name":[6],"type":["int"],"align":["right"]},{"label":["data_cols"],"name":[7],"type":["int"],"align":["right"]},{"label":["data_size"],"name":[8],"type":["lbstr_by"],"align":["right"]},{"label":["data_na_pct"],"name":[9],"type":["formttbl"],"align":["right"]},{"label":["form_complete_pct"],"name":[10],"type":["formttbl"],"align":["right"]}],"data":[{"1":"heroes_information","2":"Heroes Information","3":"<tibble[,12]>","4":"<tibble[,17]>","5":"nonrepeating","6":"734","7":"12","8":"123.24 kB","9":"0.23%","10":"0%"},{"1":"super_hero_powers","2":"Super Hero Powers","3":"<tibble[,4]>","4":"<tibble[,17]>","5":"repeating","6":"5966","7":"4","8":"180.21 kB","9":"0%","10":"0%"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>The <code>superheroes</code> supertibble contains two rows, one for
each <a href="glossary.html#instrument">instrument</a> of the
Superheroes REDCap <a href="glossary.html#project">project</a>. The
<code><a href="../reference/write_redcap_xlsx.html">write_redcap_xlsx()</a></code> function, leveraging the <a href="https://janmarvin.github.io/openxlsx2/" class="external-link">openxlsx2</a> package,
understands the supertibble’s structure and creates a
collaborator-friendly XLSX file.</p>
<p>Let’s try it out!</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">superheroes</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/write_redcap_xlsx.html">write_redcap_xlsx</a></span><span class="op">(</span>file <span class="op">=</span> <span class="st">"superheroes.xlsx"</span><span class="op">)</span></span></code></pre></div>
<p>When you open the Excel document, you’ll see multiple sheets. The
first one is the <strong>Table of Contents</strong> sheet, followed by
individual sheets for each instrument’s data, and concluded with a
<strong>REDCap Metadata</strong> sheet.</p>
<center>
<div class="float">
<img src="images%2Fwrite_xlsx_default.png" alt="Table of Contents sheet of superheroes.xlsx"><div class="figcaption">Table of Contents sheet of
<code>superheroes.xlsx</code>
</div>
</div>
</center>
<p>The <strong>Table of Contents</strong> sheet provides an overview of
the data present in the rest of the document. If you wish to exclude
this sheet, set the <code>include_toc_sheet</code> argument of
<code><a href="../reference/write_redcap_xlsx.html">write_redcap_xlsx()</a></code> to <code>FALSE</code>.</p>
<p>Each instrument’s data is contained in a separate sheet. For a better
understanding of how REDCapTidieR represents REDCap data, refer to the
<strong>Diving Deeper</strong> vignette.</p>
<p>The column headers come with pre-applied filters (notice the arrow on
the right side of each header cell), making data exploration
straightforward.</p>
<center>
<div class="float">
<img src="images%2Fwrite_xlsx_heroes_information.png" alt="A data sheet of superheroes.xlsx"><div class="figcaption">A data sheet of
<code>superheroes.xlsx</code>
</div>
</div>
</center>
<p>The <strong>REDCap Metadata</strong> sheet offers metadata for
<em>all</em> fields from <em>all</em> instruments in one place. If you
don’t want this sheet, set the <code>include_metadata_sheet</code>
argument of <code><a href="../reference/write_redcap_xlsx.html">write_redcap_xlsx()</a></code> to <code>FALSE</code>.</p>
<center>
<div class="float">
<img src="images%2Fwrite_xlsx_metadata.png" alt="REDCap Metadata sheet of superheroes.xlsx"><div class="figcaption">REDCap Metadata sheet of
<code>superheroes.xlsx</code>
</div>
</div>
</center>
<div class="section level3">
<h3 id="applying-labels">Applying Labels<a class="anchor" aria-label="anchor" href="#applying-labels"></a>
</h3>
<p>Labels can offer valuable context to collaborators, helping them
understand the data in a specific column. The
<code><a href="../reference/make_labelled.html">make_labelled()</a></code> function allows you to add <a href="glossary.html#variable-label">variable labels</a> to a
REDCapTidieR <a href="glossary.html#supertibble">supertibble</a>, and
<code><a href="../reference/write_redcap_xlsx.html">write_redcap_xlsx()</a></code> can integrate these labels to the Excel
sheets.</p>
<p>Let’s add variable labels to <code>superheroes</code> and export it
to Excel:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">superheroes</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/make_labelled.html">make_labelled</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/write_redcap_xlsx.html">write_redcap_xlsx</a></span><span class="op">(</span><span class="st">"superheroes-labelled.xlsx"</span><span class="op">)</span></span></code></pre></div>
<p>Observe how the first row now contains a human-readable description
for each column.</p>
<center>
<div class="float">
<img src="images%2Fwrite_xlsx_supertbl_labelled.png" alt="Labelled supertbl output"><div class="figcaption">Labelled supertbl output</div>
</div>
</center>
</div>
<div class="section level3">
<h3 id="recoding-logical-columns">Recoding Logical Columns<a class="anchor" aria-label="anchor" href="#recoding-logical-columns"></a>
</h3>
<p>By default, <code><a href="../reference/write_redcap_xlsx.html">write_redcap_xlsx()</a></code> recodes logical
(<code>TRUE</code>/<code>FALSE</code>) columns into more human-friendly
terms. You can adjust this behavior using the
<code>recode_logical</code> argument:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">supertbl</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/write_redcap_xlsx.html">write_redcap_xlsx</a></span><span class="op">(</span>recode_logical <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><code><a href="../reference/write_redcap_xlsx.html">write_redcap_xlsx()</a></code> uses the <a href="glossary.html#field-label">field label</a> to decide how to recode
logical fields:</p>
<ul>
<li>Columns derived from <strong>yesno</strong> fields are recoded from
<code>TRUE</code>/<code>FALSE</code> to
<code>yes</code>/<code>no</code>
</li>
<li>Columns derived from <strong>checkbox</strong> fields are recoded
from <code>TRUE</code>/<code>FALSE</code> to
<code>Checked</code>/<code>Unchecked</code>
</li>
<li>Columns derived from <strong>truefalse</strong> fields are left as
is (<code>TRUE</code>/<code>FALSE</code>)</li>
</ul>
<p>Setting <code>recode_logical</code> to <code>FALSE</code> will
preserve all logical fields as
(<code>TRUE</code>/<code>FALSE</code>).</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Richard Hanna, Stephan Kadauke, Ezra Porter.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
